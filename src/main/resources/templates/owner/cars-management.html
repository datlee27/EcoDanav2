<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head}"></head>
<body>
<style>
    .primary { color: #4CAF50; }
    .bg-primary { background-color: #4CAF50; }
    .hidden { display: none; }
</style>
<div th:replace="~{fragments/nav :: nav}"></div>
<div th:replace="~{owner/owner-sidebar :: sidebar}"></div>

<div class="ml-64 mt-16">
    <div class="bg-white shadow-sm border-b">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">Car Management</h1>
                    <p class="text-gray-600">Manage your vehicles</p>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-white text-lg"></i>
                    </div>
                    <div>
                        <p class="font-semibold text-gray-800" th:text="${currentUser?.firstName + ' ' + currentUser?.lastName ?: 'Owner'}">Owner</p>
                        <p class="text-sm text-gray-600">Car Owner</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-6">
        <!-- Car Management Content -->
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">My Cars</h2>
            <button onclick="toggleAddCar()" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center">
                <i class="fas fa-plus mr-2"></i>Add New Car
            </button>
        </div>

        <div class="bg-white rounded-xl shadow-md overflow-x-auto">
            <table class="min-w-full">
                <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Image</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Model</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Plate</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Status</th>
                    <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Actions</th>
                </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                <tr th:each="v : ${vehicles}">
                    <td class="px-6 py-4">
                        <img th:src="${v.mainImageUrl ?: 'https://via.placeholder.com/80x50?text=No+Image'}" class="w-20 h-12 object-cover rounded" th:alt="${v.vehicleModel ?: 'Vehicle'}"/>
                    </td>
                    <td class="px-6 py-4" th:text="${v.vehicleModel ?: 'N/A'}">Model</td>
                    <td class="px-6 py-4" th:text="${v.licensePlate ?: 'N/A'}">Plate</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-3">
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" class="sr-only peer status-toggle" th:attr="data-id=${v.vehicleId}, onclick='toggleVehicleStatus(this)'" th:checked="${v.status.name() == 'Available'}"/>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-300 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"></div>
                            </label>
                            <span class="text-sm" th:text="${v.status ?: 'Unknown'}">Available</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 space-x-2">
                        <button class="px-3 py-1 text-xs rounded bg-blue-100 text-blue-700 hover:bg-blue-200" th:attr="onclick=|openEditCarModal('${v.vehicleId}')|">
                            Edit
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Add/Edit Modals would go here -->

    </div>
</div>

<script th:inline="javascript">
    /* Car management specific JS */
</script>

</body>
</html>
